# 🎯 Birthday Voucher 開発ロードマップ

この資料は、アプリ完成までの全体の流れと作業手順を整理したものです。  
開発は一人で進めることを前提に、AIとの協働を前提とした進行を想定しています。

---

## 1. 開発全体の流れ

| フェーズ | 目的 | 主な成果物 |
|-----------|------|-------------|
| 要件定義 | 何を作るか明確にする | 要件定義書.md |
| 設計 | 構造・データ・画面を整理する | プロト設計メモ.md |
| 環境構築 | Firebase・ローカル開発環境を整える | Firebaseプロジェクト, Vite/React環境 |
| 実装 | 実際の機能を作る | 各画面・Firestore接続コード |
| テスト | 動作確認・調整 | 手動チェック・修正 |
| デプロイ | 公開する | Firebase Hosting |
| 運用 | 翌年以降も使える形に保つ | バックアップ・年度更新 |

---

## 2. 各フェーズの詳細タスク

### 🧩 要件定義
- アプリの目的・利用者・機能を明文化（完了済）
- 非機能要件・運用方針を整理（完了済）

### 🧱 設計
- 画面構成とデータ構造をまとめる（プロト設計メモ.md）
- Firestoreの構造とフィールド定義を決定
- ロジック概要（残高計算・登録処理など）を整理

### ⚙️ 環境構築
1. Firebase Consoleでプロジェクトを作成  
2. Firestore・Authentication・Hosting を有効化  
3. ローカルで開発環境構築（Vite + React + Firebase SDK）  
4. `.env` に Firebase 設定情報を登録  
5. GitHub管理（任意）

### 💻 実装
1. **画面実装順序（おすすめ）**
   1. ログイン画面（Auth連携）  
   2. 残高管理画面（妻用）  
   3. 購入登録画面（夫用）  
   4. 購入履歴一覧  
   5. 有効期限表示・ロック制御  
   6. UI調整（PWA対応含む）

2. **Firestore連携**
   - `settings` コレクションで残高を管理  
   - `purchases` コレクションで履歴を管理  
   - 残高の減算ロジックを実装  

3. **バリデーション**
   - `price` は整数のみ  
   - `note` は最大50文字  
   - `balance` が負にならないよう制御

### 🧪 テスト
- 購入登録時の残高減算確認  
- 有効期限切れ時の動作確認  
- Firestoreのセキュリティルール確認（妻以外のアクセス遮断）  
- オフライン動作確認（PWAキャッシュ）

### 🚀 デプロイ
1. Firebase Hosting でデプロイ  
   ```bash
   firebase deploy --only hosting
   ```
2. スマホでPWAとしてインストール確認  
3. 初期残高・履歴登録テスト

### 🔁 運用
- 翌年度の発行時：`year` フィールドを更新し、新残高を登録  
- 古いデータは `archive` コレクションに移動または残す  
- 定期的に Firestore をエクスポート（バックアップ）  
  ```bash
  firebase firestore:export ./backup
  ```

---

## 3. 開発環境まとめ

| 項目 | 使用技術 |
|------|-----------|
| フロントエンド | React + Vite |
| バックエンド | Firebase（Firestore / Auth / Hosting） |
| スタイル | Tailwind CSS |
| デプロイ | Firebase Hosting |
| データベース | Firestore |
| 認証 | Firebase Authentication |
| 開発支援 | AI（ChatGPT etc...） |

---

## 4. 今後の拡張メモ
- 🔔 残高が0円時にLINE通知を送る（Messaging API）  
- 📊 月別集計・グラフ表示  
- 🧾 CSVエクスポート機能  
- 🗓️ 自動年度更新処理（Cloud Functions）  

---

## 💬 メモ
- 一人開発では「動く最小単位を早く完成」→「拡張」で進めるのがベスト。  
- 各フェーズで迷ったら、AIに「このステップを詳しく」と聞くと効率的。  
- 設計メモ・要件定義書・このロードマップの3点で、アプリ全体の仕様をいつでも再現できる。
